var period = 2s
var every = 2s
var data = stream

|from()
  .database('asgbackup')
  .retentionPolicy('autogen')
  .measurement('drive_info')
  .groupBy(*)
|window()
  .period(period)
  .every(every)
|alert()
  .id('{{ index .Tags "target" }}')
  .message('{{ .Level}}; Target: {{ .ID }}; Time: {{ .Time}}; Duration: {{ index .Fields "duration" }}; BackupTime: {{ index .Time }}')
  .crit(lambda: "files" == 0 AND "bytes" == 0)
  .slack()
  .log('/var/tmp/kapacitor/files.log')
